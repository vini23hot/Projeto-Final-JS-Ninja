!function(t,e,n){"use strict";const a=function(){const t=n('[data-js="tableBodyCars"]').get(),o=n('[data-js="formSubmit"]');return{init:function(){this.loadCompany(),this.initEvents(),this.loadCars()},initEvents:function(){o.on("submit",this.handleSubmit)},loadCars:function(){t.innerHTML="";const e=new XMLHttpRequest;e.open("GET","http://localhost:3000/car"),e.send(),e.onreadystatechange=function(){if(a.isReady.call(this)){JSON.parse(this.responseText).forEach(function(e){t.appendChild(a.loadNewCar(e))})}}},loadNewCar:function(t){const n=e.createDocumentFragment(),a=e.createElement("tr"),o=e.createElement("td"),s=e.createElement("td"),d=e.createElement("td"),i=e.createElement("td"),r=e.createElement("td"),l=e.createElement("td");return o.classList.add("tdImg"),o.appendChild(this.createImage(t.image)),s.textContent=t.brandModel,d.textContent=t.year,i.textContent=t.plate,r.textContent=t.color,l.classList.add("tdBtn"),l.appendChild(this.createBtnDelete()),a.appendChild(o),a.appendChild(s),a.appendChild(d),a.appendChild(i),a.appendChild(r),a.appendChild(l),n.appendChild(a)},createPostString:function(){return`image=${this.getInputValue("formUrl")}&brandModel=${this.getInputValue("formBrandModel")}&year=${this.getInputValue("formYear")}&plate=${this.getInputValue("formPlate")}&color=${this.getInputValue("formColor")}`},getInputValue:function(t){return n(`[data-js="${t}"]`).get().value},handleSubmit:function(t){t.preventDefault();const e=new XMLHttpRequest;e.open("POST","http://localhost:3000/car"),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(a.createPostString()),e.addEventListener("readystatechange",a.handleAjax,!1)},createBtnDelete:function(){const t=e.createElement("button");return t.type="button",t.textContent="Delete",t.classList.add("btnDelete"),t.addEventListener("click",this.handleBtnDelete,!1),t},handleBtnDelete:function(){const t=new XMLHttpRequest;t.open("DELETE","http://localhost:3000/car"),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(`plate=${this.parentNode.parentNode.children[3].textContent}`),t.addEventListener("readystatechange",a.handleAjax,!1)},handleAjax:function(){if(a.isReady.call(this)){const t=JSON.parse(this.responseText);console.log(`Action ${t.action}:`,t.status),a.loadCars(),a.resetFields()}},createImage:function(t){const n=e.createElement("img");return n.src=t,n},loadCompany:function(){const t=new XMLHttpRequest;t.open("GET","../data/company.json",!0),t.send(),t.addEventListener("readystatechange",this.getCompanyInfo,!1)},getCompanyInfo:function(){if(a.isReady.call(this)){const t=JSON.parse(this.responseText),e=n('[data-js="companyName"]').get(),a=n('[data-js="companyPhone"]').get();e.textContent=`${t.name} - `,a.textContent=t.phone}},isReady:function(){return 200===this.status&&4===this.readyState},resetFields:function(){o.get().reset()}}}();a.init()}(window,document,window.DOM);